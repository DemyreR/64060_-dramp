---
title: "Assignment5"
output: html_document
---

## **Load Libraries**
```{r}

library(readr)
library(cluster)
library(stats)
library(dplyr)
library(caret)
library(tidyverse)
library(factoextra)

```
<br>

## **Import Data**
```{r}

Cereals <- read_csv("Cereals.csv")

```
*Data sourced from Canvas.*

<br>

## **Turn Names Into Row Names**
```{r}

head(Cereals)
Cereals_df <- as.data.frame(Cereals)
Cereal_Names <- Cereals_df$name
rownames(Cereals_df) <- Cereal_Names
Cereals_df <- Cereals_df[,-1]
head(Cereals_df)

```
<br>

## **Remove Missing Values**
```{r}

colMeans(is.na(Cereals_df))
sum(!complete.cases(Cereals_df))
Cereals_Clean <- Cereals_df[complete.cases(Cereals_df), ]
colMeans(is.na(Cereals_Clean))

```
<br>

## **Create Dummy Variables**
```{r}

head(Cereals_Clean)
Dummies <- dummyVars(~ mfr + type, data = Cereals_Clean)
Dummy_df <- as.data.frame(predict(Dummies, newdata = Cereals_Clean))
Cereals_Num <- Cereals_Clean[,-c(1,2)]
Cereals_Num <- cbind(Dummy_df,Cereals_Num)
head(Cereals_Num)

```
<br>

## **Normalize Data**
```{r}

Norm_Model <- preProcess(Cereals_Num, method = c("center", "scale"))
Cereals_Norm <- predict(Norm_Model,Cereals_Num)
head(Cereals_Norm)

```
<br>

## **Agnes Linkage Methods**
```{r}

hc_single <- agnes(Cereals_Norm, method = "single")
hc_complete <- agnes(Cereals_Norm, method = "complete")
hc_average <- agnes(Cereals_Norm, method = "average")
hc_ward <- agnes(Cereals_Norm, method = "ward")

print(hc_single$ac)
print(hc_complete$ac) 
print(hc_average$ac)
print(hc_ward$ac) # best linkage

```
<br>

## **Agnes Dendrogram**
```{r}

pltree(hc_ward, cex = 0.6, hang = -1, main = "Dendrogram of Agnes")

```
<br>

## **Choosing Number of Clusters**
```{r}

fviz_nbclust(Cereals_Norm, hcut, method = "wss") +
  geom_hline(yintercept = 1194, linetype = 2, color = "royalblue", size = 0.5)

fviz_nbclust(Cereals_Norm, hcut, method = "silhouette")

```
<br>

## **3 Clusters Dendrogram**
```{r}

pltree(hc_ward, cex = 0.6, hang = -1, main = "Dendrogram of Agnes")
rect.hclust(as.hclust(hc_ward), k = 3, border = 2:5)

```
<br>

